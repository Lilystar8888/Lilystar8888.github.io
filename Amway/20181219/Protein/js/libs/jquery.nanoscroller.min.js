!function(e){return"function"==typeof define&&define.amd?define(["jquery"],function(n){return e(n,window,document)}):"object"==typeof exports?module.exports=e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,n,a){"use strict";var t,o,i,r,l,s,d,c,p,u,h,f,$,m,w,g,y,v,T,b,P,x,M,_,L,k,A,C,N,O,E;M={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},v="scrollbar",y="scroll",p="mousedown",u="mouseenter",h="mousemove",$="mousewheel",f="mouseup",g="resize",l="drag",s="enter",b="up",w="panedown",i="DOMMouseScroll",r="down",P="wheel",d="keydown",c="keyup",T="touchmove",t="Microsoft Internet Explorer"===n.navigator.appName&&/msie 7./i.test(n.navigator.appVersion)&&n.ActiveXObject,o=null,A=n.requestAnimationFrame,x=n.cancelAnimationFrame,N=a.createElement("div").style,E=function(){var e,n,a,t,o,i;for(t=["t","webkitT","MozT","msT","OT"],e=o=0,i=t.length;i>o;e=++o)if(a=t[e],n=t[e]+"ransform",n in N)return t[e].substr(0,t[e].length-1);return!1}(),O=function(e){return E===!1?!1:""===E?e:E+e.charAt(0).toUpperCase()+e.substr(1)},C=O("transform"),L=C!==!1,_=function(){var e,n,t;return e=a.createElement("div"),n=e.style,n.position="absolute",n.width="100px",n.height="100px",n.overflow=y,n.top="-9999px",a.body.appendChild(e),t=e.offsetWidth-e.clientWidth,a.body.removeChild(e),t},k=function(){var e,a,t;return a=n.navigator.userAgent,(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(a))?(t=/Firefox\/\d{2}\./.exec(a),t&&(t=t[0].replace(/\D+/g,"")),e&&+t>23):!1},m=function(){function d(t,i){this.el=t,this.options=i,o||(o=_()),this.$el=e(this.el),this.doc=e(this.options.documentContext||a),this.win=e(this.options.windowContext||n),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return d.prototype.preventScrolling=function(e,n){if(this.isActive)if(e.type===i)(n===r&&e.originalEvent.detail>0||n===b&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===$){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(n===r&&e.originalEvent.wheelDelta<0||n===b&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},d.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},d.prototype.updateScrollValues=function(){var e,n;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,n=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==n&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:n}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},d.prototype.setOnScrollStyles=function(){var e;L?(e={},e[C]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},A?(x&&this.scrollRAF&&x(this.scrollRAF),this.scrollRAF=A(function(n){return function(){return n.scrollRAF=null,n.slider.css(e)}}(this))):this.slider.css(e)},d.prototype.createEvents=function(){this.events={down:function(e){return function(n){return e.isBeingDragged=!0,e.offsetY=n.pageY-e.slider.offset().top,e.slider.is(n.target)||(e.offsetY=0),e.pane.addClass(e.options.activeClass),e.doc.bind(h,e.events[l]).bind(f,e.events[b]),e.body.bind(u,e.events[s]),!1}}(this),drag:function(e){return function(n){return e.sliderY=n.pageY-e.$el.offset().top-e.paneTop-(e.offsetY||.5*e.sliderHeight),e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(){return e.isBeingDragged=!1,e.pane.removeClass(e.options.activeClass),e.doc.unbind(h,e.events[l]).unbind(f,e.events[b]),e.body.unbind(u,e.events[s]),!1}}(this),resize:function(e){return function(){e.reset()}}(this),panedown:function(e){return function(n){return e.sliderY=(n.offsetY||n.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(n),!1}}(this),scroll:function(e){return function(n){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=n&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(n,r),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(n,b),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(n){var a;if(null!=n)return a=n.delta||n.wheelDelta||n.originalEvent&&n.originalEvent.wheelDelta||-n.detail||n.originalEvent&&-n.originalEvent.detail,a&&(e.sliderY+=-a/3),e.scroll(),!1}}(this),enter:function(e){return function(n){var a;if(e.isBeingDragged)return 1!==(n.buttons||n.which)?(a=e.events)[b].apply(a,arguments):void 0}}(this)}},d.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(g,e[g]),this.iOSNativeScrolling||(this.slider.bind(p,e[r]),this.pane.bind(p,e[w]).bind(""+$+" "+i,e[P])),this.$content.bind(""+y+" "+$+" "+i+" "+T,e[y])},d.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(g,e[g]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+y+" "+$+" "+i+" "+T,e[y])},d.prototype.generate=function(){var e,a,t,i,r,l,s;return i=this.options,l=i.paneClass,s=i.sliderClass,e=i.contentClass,(r=this.$el.children("."+l)).length||r.children("."+s).length||this.$el.append('<div class="'+l+'"><div class="'+s+'" /></div>'),this.pane=this.$el.children("."+l),this.slider=this.pane.find("."+s),0===o&&k()?(t=n.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),a={right:-14,paddingRight:+t+14}):o&&(a={right:-o},this.$el.addClass(i.enabledClass)),null!=a&&this.$content.css(a),this},d.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},d.prototype.reset=function(){var e,n,a,i,r,l,s,d,c,p,u;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,i=e.style,r=i.overflowY,t&&this.$content.css({height:this.$content.height()}),n=e.scrollHeight+o,p=parseInt(this.$el.css("max-height"),10),p>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>p?p:e.scrollHeight)),s=this.pane.outerHeight(!1),c=parseInt(this.pane.css("top"),10),l=parseInt(this.pane.css("bottom"),10),d=s+c+l,u=Math.round(d/n*s),u<this.options.sliderMinHeight?u=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&u>this.options.sliderMaxHeight&&(u=this.options.sliderMaxHeight),r===y&&i.overflowX!==y&&(u+=o),this.maxSliderTop=d-u,this.contentHeight=n,this.paneHeight=s,this.paneOuterHeight=d,this.sliderHeight=u,this.paneTop=c,this.slider.height(u),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&r!==y?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&r===y?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),a=this.$content.css("position"),this)},d.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},d.prototype.scrollBottom=function(e){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger($),this.stop().restore(),this):void 0},d.prototype.scrollTop=function(e){return this.isActive?(this.$content.scrollTop(+e).trigger($),this.stop().restore(),this):void 0},d.prototype.scrollTo=function(e){return this.isActive?(this.scrollTop(this.$el.find(e).get(0).offsetTop),this):void 0},d.prototype.stop=function(){return x&&this.scrollRAF&&(x(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},d.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),t&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},d.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout(function(e){return function(){e.pane.removeClass(e.options.flashedClass)}}(this),this.options.flashDelay),this):void 0},d}(),e.fn.nanoScroller=function(n){return this.each(function(){var a,t;if((t=this.nanoscroller)||(a=e.extend({},M,n),this.nanoscroller=t=new m(this,a)),n&&"object"==typeof n){if(e.extend(t.options,n),null!=n.scrollBottom)return t.scrollBottom(n.scrollBottom);if(null!=n.scrollTop)return t.scrollTop(n.scrollTop);if(n.scrollTo)return t.scrollTo(n.scrollTo);if("bottom"===n.scroll)return t.scrollBottom(0);if("top"===n.scroll)return t.scrollTop(0);if(n.scroll&&n.scroll instanceof e)return t.scrollTo(n.scroll);if(n.stop)return t.stop();if(n.destroy)return t.destroy();if(n.flash)return t.flash()}return t.reset()})},e.fn.nanoScroller.Constructor=m});
