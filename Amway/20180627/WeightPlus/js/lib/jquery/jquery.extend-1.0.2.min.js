(function(n){typeof define=="function"&&define.amd?define(["jquery"].concat(window.JSON?[]:["json2"]),n):n(jQuery)})(function(){var n=navigator.userAgent;$.isiPad=/ipad;/i.test(n);$.isIOS=$.isiPad||/(iphone|ipod);/i.test(n);$.isAndroid=/(android)/i.test(n);$.isMobile=$.isIOS||$.isAndroid;$.isTouchSupport="ontouchstart"in window||"onmsgesturechange"in window;$.shuffle=function(n){for(var t=n.length;t>0;t--)n.push(n.splice(~~(Math.random()*t),1)[0]);return n||[]};$.val=function(n,t){var i,r;if(typeof n=="undefined")return i;for(t=t.split("."),r=0;r<t.length;r++){if(i=n[t[r]],typeof i=="undefined")break;n=i}return i};$.isFlashSupported=function(){if(window.ActiveXObject)try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(n){}return navigator.plugins["Shockwave Flash"]?!0:!1};$.validChinese=function(n){return/^[\u4E00-\u9FFF]*$/.test(""+n)};$.validEMail=function(n){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(""+n)};$.validMobile=function(n){return/^09[0-9]{8}$/.test(""+n)};$.validTel=function(n){return/(^0([0-9]{8,9})+((\#([0-9]){1,5}){0,1})$)|(^0([0-9]{1,2})\-([0-9]{6,8})+((\#([0-9]){1,5}){0,1})$)|(^\(0([0-9]{1,2})\)([0-9]{6,8})+((\#([0-9]){1,5}){0,1})|(^09[0-9]{8})|(^09[0-9]{2})+(\-([0-9]{6}))|(^09[0-9]{2})+(\-([0-9]{3}))+(\-([0-9]{3}))$)/.test(""+n)};$.resolve=function(n){if(n=n.replace(/^~\//,CONST.root||"/"),!n)return window.location.href;var t=document.createElement("div");return t.innerHTML='<a href="'+n.replace(/"/g,"&quot;")+'"><\/a>',t.firstChild.href};$.static=function(n){return n=n.replace(/^~\//,CONST.static||CONST.root||"/"),$.resolve(n)};$.queryString=function(n){var t=window.location.search.substring(1).split("&");for(i=0;i<t.length;i++)if(t[i].split("=")[0]==n)return decodeURIComponent(t[i].split("=")[1]);return""};$.hashString=function(n){var t=window.location.hash.substring(1).split("&");for(i=0;i<t.length;i++)if(t[i].split("=")[0]==n)return decodeURIComponent(t[i].split("=")[1]);return""};$.geoLocation=function(n){function i(){$.getJSON("//freegeoip.net/json/?callback=?").done(function(n){t.resolve(n.latitude,n.longitude)}).fail(function(){var i=n["default"];i?t.resolve(i.lat,i.lng):t.reject()})}var t=$.Deferred();return navigator.geolocation?(n=typeof n=="number"?{enableHighAccurary:!1,maximumAge:0,timeout:n}:$.extend({},{enableHighAccurary:!1,maximumAge:0,timeout:15e3},n),navigator.geolocation.getCurrentPosition(function(n){t.resolve(n.coords.latitude,n.coords.longitude)},i,n)):i(),t.promise()};$.any=function(){var n=$.Deferred(),t=arguments.length;return arguments.length?$.each(arguments,function(i,r){r.done(function(){n.resolve()}).fail(function(){--t||n.reject()})}):n.resolve(),n.promise()};$.delay=function(n){var t=$.Deferred();return setTimeout(t.resolve,n),t};$.repeat=function(n,t,i){var u=$.Deferred(),r;return function f(){var e=!0;i&&(e=n());i=!0;e===!1?u.reject():(clearTimeout(r),r=setTimeout(f,t))}(),u.fail(function(){clearTimeout(r)})};$.callAPI=function(n,t,i){function f(n){return u.alertErrMsg&&alert(u.alertErrMsg),n}var u=$.extend({},$.callAPI.settings,i),r;return u.url=n,t&&$.extend(u,{type:"POST",data:t}),u.isHideLoading||(u.beforeSend=function(){$.loading(250)}),r=$.Deferred(),$.ajax(u).done(function(n,t,i){var u=n;if($.trim(n).substr(0,1)=="{"&&(u=JSON.parse(n),u.ErrMsg||u.ErrorMessage)){r.reject.apply(r,[f(u.ErrMsg||u.ErrorMessage),i,"error","Response Error Data"]);return}r.resolve.apply(r,[u].concat(Array.prototype.slice.call(arguments,1)))}).fail(function(n){n?n.status==0?r.reject.apply(r,[f("0: unknow!!")].concat(Array.prototype.slice.call(arguments,0))):r.reject.apply(r,[f(n.status+": "+n.statusText)].concat(Array.prototype.slice.call(arguments,0))):r.reject.apply(r,[f("999: error!!")].concat(Array.prototype.slice.call(arguments,0)))}).always(function(){u.isHideLoading||$.loading("hide")}),r.promise()};$.callAPI.settings={global:!1,cache:!1,async:!0,dataType:"html",type:"GET",timeout:6e4,alertErrMsg:"伺服器忙碌中，請稍候再試。",isHideLoading:!1},function(){var n=null;$.loading=function(t){if(n&&(clearTimeout(n),n=null),t=="hide")$("#ibLoading").remove();else{if($("#ibLoading").length)return;function i(){$("#ibLoading").length||$('<div id="ibLoading"><div/><img/><\/div>').css({display:"block",position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":$.loading.settings.zIndex}).find("div").css({position:"absolute","background-color":$.loading.settings.overlayBgColor,opacity:$.loading.settings.overlayOpacity,top:0,left:0,width:"100%",height:"100%"}).end().find("img").attr("src",$.loading.settings.imageURL).css({position:"absolute",top:"50%",left:"50%","margin-top":"-"+$.loading.settings.imageHeight/2+"px","margin-left":"-"+$.loading.settings.imageWidth/2+"px",width:$.loading.settings.imageWidth,height:$.loading.settings.imageHeight}).end().appendTo("body")}$.isNumeric(t)?n=setTimeout(i,t):i()}};$.loading.settings={overlayBgColor:"#000",overlayOpacity:.7,zIndex:99999999,imageURL:"//www.facebook.com/images/loaders/indicator_blue_large.gif",imageWidth:32,imageHeight:32}}();$.fn.template=function(n){var t=this;return $.map($.isArray(n)?n:[n],function(n){for(var i=t.html().replace("<!--","").replace("-->","");m=i.match(/\{(\w+)\}/);)i=i.replace(m[0],n[m[1]]||"");return i}).join("")};$.fn.once=function(){var n=arguments;return this.each(function(){var t=this,i=[];$(n).each(function(n,r){$.isFunction(r)?i.push(function(){var n=r.apply(this,Array.prototype.slice.call(arguments,0));$.isPlainObject(n)?n.always(function(){$(t).one.apply($(t),i)}):$(t).one.apply($(t),i)}):i.push(r)});$(t).one.apply($(t),i)})}});