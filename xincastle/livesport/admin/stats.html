<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title>後台首頁-星城體育</title>
    <meta name="description" content="Static &amp; Dynamic Tables" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link rel="shortcut icon" href="favicon.ico" />
    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />
    <!-- page specific plugin styles -->
    <link rel="stylesheet" href="assets/css/jquery-ui.min.css" />
    <link rel="stylesheet" href="css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />
</head>

<body class="no-skin">
    <div id="load">
        <div class="loading"></div>
        <span class="count">100</span>
    </div>
    <div id="navbar" class="navbar navbar-default ace-save-state">
        <div class="navbar-container ace-save-state" id="navbar-container">
            <button type="button" class="navbar-toggle menu-toggler pull-left" id="menu-toggler" data-target="#sidebar">
                <span class="sr-only">Toggle sidebar</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-header pull-left">
                <a href="index.html" class="navbar-brand"><small><i class="sslogo"></i>XINCASTLE-SPORTS</small></a>
            </div>
            <div class="navbar-buttons navbar-header pull-right" role="navigation">
                <ul class="nav ace-nav">
                    <li class="light-blue dropdown-modal">
                        <a data-toggle="dropdown" href="#" class="dropdown-toggle"><img class="nav-user-photo" src="assets/images/avatars/user.jpg" alt="Jason's Photo" /><span class="user-info"><small>當前登入為</small>Jason</span><i class="ace-icon fa fa-caret-down"></i></a>
                        <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                            <li><a href="profile.html"><i class="ace-icon fa fa-user"></i>關於我</a></li>
                            <li class="divider"></li>
                            <li><a href="login.html"><i class="ace-icon fa fa-power-off"></i>登出</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <!-- /.navbar-container -->
    </div>
    <div class="main-container ace-save-state" id="main-container">
        <div id="sidebar" class="sidebar responsive ace-save-state">
            <div class="sidebar-shortcuts" id="sidebar-shortcuts">
                <div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
                    <button class="btn btn-success">
                        <i class="ace-icon icon1"></i>
                    </button>
                    <button class="btn btn-info">
                        <i class="ace-icon icon2"></i>
                    </button>
                    <button class="btn btn-warning">
                        <i class="ace-icon icon3"></i>
                    </button>
                    <button class="btn btn-danger">
                        <i class="ace-icon icon4"></i>
                    </button>
                </div>
                <div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
                    <span class="btn btn-success"></span>
                    <span class="btn btn-info"></span>
                    <span class="btn btn-warning"></span>
                    <span class="btn btn-danger"></span>
                </div>
            </div>
            <!-- /.sidebar-shortcuts -->
            <ul class="nav nav-list">
                <li>
                    <a href="index.html"><i class="menu-icon fa fa-home"></i><span class="menu-text">後台首頁</span></a>
                    <b class="arrow"></b>
                </li>
                <li class="">
                    <a href="live.html"><i class="menu-icon fa fa-desktop"></i><span class="menu-text">視訊直播</span></a>
                    <b class="arrow"></b>
                </li>
                <li class="">
                    <a href="report.html"><i class="menu-icon fa fa-calculator"></i><span class="menu-text">帳務報表</span></a>
                    <b class="arrow"></b>
                </li>
                <li class="">
                    <a href="reissue.html"><i class="menu-icon fa fa-dollar"></i><span class="menu-text">星幣補發</span></a>
                    <b class="arrow"></b>
                </li>
                <li class="">
                    <a href="schedule.html"><i class="menu-icon fa fa-calendar"></i><span class="menu-text">主播預約</span></a>
                    <b class="arrow"></b>
                </li>
                <li class="active">
                    <a href="stats.html"><i class="menu-icon fa fa-tachometer"></i><span class="menu-text">流量統計</span></a>
                    <b class="arrow"></b>
                </li>
            </ul>
            <!-- /.nav-list -->
            <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
                <i id="sidebar-toggle-icon" class="ace-icon fa fa-angle-double-left ace-save-state" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
            </div>
        </div>
        <div class="main-content">
            <div class="main-content-inner">
                <div class="breadcrumbs ace-save-state" id="breadcrumbs">
                    <ul class="breadcrumb">
                        <li>
                            <i class="ace-icon fa fa-home home-icon"></i>
                            <a href="#">首頁</a>
                        </li>
                        <li class="active">流量統計</li>
                    </ul>
                    <!-- /.breadcrumb -->
                    <div class="nav-search" id="nav-search">
                        <form class="form-search">
                            <span class="input-icon"><input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" /><i class="ace-icon fa fa-search nav-search-icon"></i></span>
                        </form>
                    </div>
                    <!-- /.nav-search -->
                </div>
                <div class="page-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <!-- PAGE CONTENT BEGINS -->
                            <div class="row">
                                <div class="col-md-6 col-sm-12">
                                    <div class="statgraph">
                                        <div class="infobox">
                                            <div class="infobox-data">
                                                <span class="infobox-data-number">6,251</span>
                                                <div class="infobox-content">pageviews</div>
                                            </div>
                                            <!--badge-danger紅色 badge-success綠色-->
                                            <div class="badge badge-danger">7.2%<i class="ace-icon fa fa-arrow-up"></i></div>
                                        </div>
                                        <div id="flot-placeholder" style="width:100%;height:370px"></div>
                                        <div class="date-panel">
                                            <span id="lastmonth" class="prem" title="上個月"><i class="fa fa-arrow-left"></i></span>
                                            <input type="text" id="monthly" name="monthly" value="2018-09" size="8">
                                            <span>流量統計</span>
                                            <span id="nextmonth" class="nxtm" title="下個月"><i class="fa fa-arrow-right"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <!--col-md-6 col-sm-12-->
                                <div class="col-md-6 col-sm-12">
                                    <div class="statmap">
                                        <div id="map" style="position:relative;width:100%;height:360px;"></div>
                                        <button class="zoom-button" data-zoom="reset">0</button>
                                        <button class="zoom-button" data-zoom="out">-</button>
                                        <button class="zoom-button" data-zoom="in">+</button>
                                        <div id="zoom-info"></div>
                                    </div>
                                </div>
                                <!--col-md-6 col-sm-12-->
                            </div>
                            <!-- /.row -->
                            <div class="row">
                                <div class="hr hr32 hr-dotted"></div>
                                <div class="date-panel btm">
                                    請選擇日期：
                                    <div class="input-group inputgroups2">
                                        <span id="lastday" class="input-group-addon" title="往前一天"><i class="fa fa-chevron-left glyphicon glyphicon-chevron-left"></i></span>
                                        <input type="text" name="datepicker" id="datepicker" size="12" value="2018-09-04">
                                        <span id="nextday" class="input-group-addon" title="往後一天"><i class="fa fa-chevron-right glyphicon glyphicon-chevron-right"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-3 col-sm-12">
                                    <div class="widget-box transparent">
                                        <div class="widget-header widget-header-flat">
                                            <h4 class="widget-title lighter"><i class="ace-icon fa fa-star red"></i>頁面流量</h4>
                                            <div class="widget-toolbar">
                                                <a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
                                            </div>
                                        </div>
                                        <div class="widget-body">
                                            <div class="widget-main no-padding">
                                                <table class="table table-bordered table-striped">
                                                    <thead class="thin-border-bottom">
                                                        <tr>
                                                            <th>
                                                                項目
                                                            </th>
                                                            <th>
                                                                瀏覽量
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>首頁</td>
                                                            <td>121</td>
                                                        </tr>
                                                        <tr>
                                                            <td>數據分析</td>
                                                            <td>67</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.widget-main -->
                                        </div>
                                        <!-- /.widget-body -->
                                    </div>
                                    <!-- /.widget-box -->
                                </div>
                                <!-- /.col -->
                                <div class="col-md-3 col-sm-12">
                                    <div class="widget-box transparent">
                                        <div class="widget-header widget-header-flat">
                                            <h4 class="widget-title lighter"><i class="ace-icon fa fa-star red"></i>地區流量</h4>
                                            <div class="widget-toolbar">
                                                <a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
                                            </div>
                                        </div>
                                        <div class="widget-body">
                                            <div class="widget-main no-padding">
                                                <table class="table table-bordered table-striped">
                                                    <thead class="thin-border-bottom">
                                                        <tr>
                                                            <th>地區</th>
                                                            <th>瀏覽量</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>北京</td>
                                                            <td>121</td>
                                                        </tr>
                                                        <tr>
                                                            <td>上海</td>
                                                            <td>67</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.widget-main -->
                                        </div>
                                        <!-- /.widget-body -->
                                    </div>
                                    <!-- /.widget-box -->
                                </div>
                                <!-- /.col -->
                            </div>
                            <!-- /.row -->
                        </div>
                        <!-- /.col -->
                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.page-content -->
            </div>
        </div>
        <!-- /.main-content -->
        <div class="footer">
            <div class="footer-inner">
                <div class="footer-content">
                    <span class="bigger-120"><span class="blue bolder">星城體育</span> 版權所有 &copy;
                    </span>
                </div>
            </div>
        </div>
        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse"><i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i></a>
    </div>
    <!-- /.main-container -->
    <!-- basic scripts -->
    <!--[if !IE]> -->
    <script src="assets/js/jquery-2.1.4.min.js"></script>
    <!--Loading-->
    <script>
    $(function() {
        var loading = {
            loadingShow: function() {
                $("#load").show();
                $('.count').each(function() {
                    $(this).prop('Counter', 0).animate({
                        Counter: $(this).text()
                    }, {
                        duration: 2000, //loading的時間
                        easing: 'swing',
                        step: function(now) {
                            $(this).text(Math.ceil(now));
                        }
                    });
                });
                var loadingTimer = setTimeout(function() {
                    $("#load").hide();
                }, 2000); //loading的時間
            },
            loadingHide: function() {
                $("#load").hide();
            }
        }
        loading.loadingShow();

    });
    </script>
    <!-- <![endif]-->
    <!--[if IE]>
    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
    if ('ontouchstart' in document.documentElement) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- page specific plugin scripts -->
    <!--[if lte IE 8]>
          <script src="assets/js/excanvas.min.js"></script>
    <![endif]-->
    <script src="assets/js/jquery-ui.min.js"></script>
    <script src="assets/js/jquery.ui.touch-punch.min.js"></script>
    <script src="assets/js/jquery.flot.min.js"></script>
    <script src="assets/js/jquery.flot.axislabels.js"></script>
    <script src="assets/js/jquery.flot.barnumbers.js"></script>
    <script src="assets/js/d3.min.js"></script>
    <script src="assets/js/topojson.min.js"></script>
    <script src="assets/js/datamaps.world.min.js"></script>
    <!-- ace scripts -->
    <script src="assets/js/ace-elements.min.js"></script>
    <script src="assets/js/ace.min.js"></script>
    <!-- inline scripts related to this page -->
    <!--流量統計直條圖-->
    <script type="text/javascript">
    jQuery(function($) {
        var data = [
            [0, 11],
            [1, 15],
            [2, 25],
            [3, 24],
            [4, 13],
            [5, 18],
            [6, 22],
            [7, 30],
            [8, 50],
            [9, 48],
            [10, 22],
            [11, 30],
            [12, 50],
            [13, 48],
            [14, 26],
            [15, 36],
            [16, 44],
            [17, 60],
            [18, 100],
            [19, 96],
            [20, 22],
            [21, 60],
            [22, 100],
            [23, 96],
            [24, 52],
            [25, 72],
            [26, 88],
            [27, 120],
            [28, 200],
            [29, 192],
            [30, 384]
        ];
        var dataset = [{ data: data, color: "#de1030" }];
        var options = {
            xaxis: {
                ticks: [
                    [0, "1"],
                    [1, "2"],
                    [2, "3"],
                    [3, "4"],
                    [4, "5"],
                    [5, "6"],
                    [6, "7"],
                    [7, "8"],
                    [8, "9"],
                    [9, "10"],
                    [10, "11"],
                    [11, "12"],
                    [12, "13"],
                    [13, "14"],
                    [14, "15"],
                    [15, "16"],
                    [16, "17"],
                    [17, "18"],
                    [18, "19"],
                    [19, "20"],
                    [20, "21"],
                    [21, "22"],
                    [22, "23"],
                    [23, "88"],
                    [24, "25"],
                    [25, "26"],
                    [26, "27"],
                    [27, "28"],
                    [28, "29"],
                    [29, "30"],
                    [30, "31"]
                ],
                axisLabel: "",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 12,
                axisLabelPadding: 0
            },
            yaxis: {
                axisLabel: "日瀏覽量",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 12,
                axisLabelPadding: 3,
                tickFormatter: function(v, axis) {
                    return v + "人次";
                }
            },
            series: {
                lines: {
                    show: true,
                    lineWidth: 1,
                },
                bars: {
                    show: true,
                    lineWidth: 0,
                    fillColor: "#FF892A",
                    align: "center",
                    barWidth: 0.6,
                    numbers: {
                        show: true,
                        yAlign: function(y) { return y + 15; },
                    },
                },
            },
            grid: {
                hoverable: true,
                mouseActiveRadius: 50,
                backgroundColor: { colors: ["#ffffff", "#EDF5FF"] },
                autoHighlight: false,
                borderColor: 'transparent',
            },
        };

        $(document).ready(function() {
            var p = $.plot($("#flot-placeholder"), dataset, options);
        });
    });
    </script>
    <!--DataMaps 自動縮放-->
    <script type="text/javascript">
    function Zoom(args) {
        $.extend(this, {
            $buttons: $(".zoom-button"),
            $info: $("#zoom-info"),
            scale: { max: 50, currentShift: 0 },
            $container: args.$container,
            datamap: args.datamap
        });

        this.init();
    }

    Zoom.prototype.init = function() {
        var paths = this.datamap.svg.selectAll("path"),
            subunits = this.datamap.svg.selectAll(".datamaps-subunit");

        // preserve stroke thickness
        paths.style("vector-effect", "non-scaling-stroke");

        // disable click on drag end
        subunits.call(
            d3.behavior.drag().on("dragend", function() {
                d3.event.sourceEvent.stopPropagation();
            })
        );

        this.scale.set = this._getScalesArray();
        this.d3Zoom = d3.behavior.zoom().scaleExtent([1, this.scale.max]);

        this._displayPercentage(1);
        this.listen();
    };

    Zoom.prototype.listen = function() {
        this.$buttons.off("click").on("click", this._handleClick.bind(this));

        this.datamap.svg
            .call(this.d3Zoom.on("zoom", this._handleScroll.bind(this)))
            .on("dblclick.zoom", null); // disable zoom on double-click
    };

    Zoom.prototype.reset = function() {
        this._shift("reset");
    };

    Zoom.prototype._handleScroll = function() {
        var translate = d3.event.translate,
            scale = d3.event.scale,
            limited = this._bound(translate, scale);

        this.scrolled = true;

        this._update(limited.translate, limited.scale);
    };

    Zoom.prototype._handleClick = function(event) {
        var direction = $(event.target).data("zoom");

        this._shift(direction);
    };

    Zoom.prototype._shift = function(direction) {
        var center = [this.$container.width() / 2, this.$container.height() / 2],
            translate = this.d3Zoom.translate(),
            translate0 = [],
            l = [],
            view = {
                x: translate[0],
                y: translate[1],
                k: this.d3Zoom.scale()
            },
            bounded;

        translate0 = [
            (center[0] - view.x) / view.k,
            (center[1] - view.y) / view.k
        ];

        if (direction == "reset") {
            view.k = 1;
            this.scrolled = true;
        } else {
            view.k = this._getNextScale(direction);
        }

        l = [translate0[0] * view.k + view.x, translate0[1] * view.k + view.y];

        view.x += center[0] - l[0];
        view.y += center[1] - l[1];

        bounded = this._bound([view.x, view.y], view.k);

        this._animate(bounded.translate, bounded.scale);
    };

    Zoom.prototype._bound = function(translate, scale) {
        var width = this.$container.width(),
            height = this.$container.height();

        translate[0] = Math.min(
            (width / height) * (scale - 1),
            Math.max(width * (1 - scale), translate[0])
        );

        translate[1] = Math.min(0, Math.max(height * (1 - scale), translate[1]));

        return { translate: translate, scale: scale };
    };

    Zoom.prototype._update = function(translate, scale) {
        this.d3Zoom
            .translate(translate)
            .scale(scale);

        this.datamap.svg.selectAll("g")
            .attr("transform", "translate(" + translate + ")scale(" + scale + ")");

        this._displayPercentage(scale);
    };

    Zoom.prototype._animate = function(translate, scale) {
        var _this = this,
            d3Zoom = this.d3Zoom;

        d3.transition().duration(350).tween("zoom", function() {
            var iTranslate = d3.interpolate(d3Zoom.translate(), translate),
                iScale = d3.interpolate(d3Zoom.scale(), scale);

            return function(t) {
                _this._update(iTranslate(t), iScale(t));
            };
        });
    };

    Zoom.prototype._displayPercentage = function(scale) {
        var value;

        value = Math.round(Math.log(scale) / Math.log(this.scale.max) * 100);
        this.$info.text(value + "%");
    };

    Zoom.prototype._getScalesArray = function() {
        var array = [],
            scaleMaxLog = Math.log(this.scale.max);

        for (var i = 0; i <= 10; i++) {
            array.push(Math.pow(Math.E, 0.1 * i * scaleMaxLog));
        }

        return array;
    };

    Zoom.prototype._getNextScale = function(direction) {
        var scaleSet = this.scale.set,
            currentScale = this.d3Zoom.scale(),
            lastShift = scaleSet.length - 1,
            shift, temp = [];

        if (this.scrolled) {

            for (shift = 0; shift <= lastShift; shift++) {
                temp.push(Math.abs(scaleSet[shift] - currentScale));
            }

            shift = temp.indexOf(Math.min.apply(null, temp));

            if (currentScale >= scaleSet[shift] && shift < lastShift) {
                shift++;
            }

            if (direction == "out" && shift > 0) {
                shift--;
            }

            this.scrolled = false;

        } else {

            shift = this.scale.currentShift;

            if (direction == "out") {
                shift > 0 && shift--;
            } else {
                shift < lastShift && shift++;
            }
        }

        this.scale.currentShift = shift;

        return scaleSet[shift];
    };

    function Datamap() {
        this.$container = $("#map");
        this.instance = new Datamaps({
            scope: 'world',
            geographyConfig: {
                popupOnHover: true,
                highlightOnHover: true,
                highlightFillColor: "#bbb",
                highlightBorderColor: "transparent",
            },
            fills: {
                defaultFill: '#ddd',
                spots: '#002f5f',
                hotspots: '#de1030',
            },
            bubblesConfig: {
                borderWidth: 0,
                popupOnHover: true,
                radius: 1,
            },
            element: this.$container.get(0),
            projection: 'mercator',
            done: this._handleMapReady.bind(this),
        });

    }

    Datamap.prototype._handleMapReady = function(datamap) {
        this.zoom = new Zoom({
            $container: this.$container,
            datamap: datamap
        });
    }

    //繪製地圖
    var map = new Datamap();

    //取得資料
    $.getJSON("bubbles.json", function(data) {
        map.instance.bubbles(data, {
            popupTemplate: function(geo, data) {
                return '<div class="hoverinfo">地點:' + data.city + '<BR/>時間:' + data.timestamp + '<BR/>觀看數:' + data.views
            }
        })
    });

    //顯示經緯線
    map.instance.graticule();
    </script>

    <script type="text/javascript">
        //日曆套件 不需要可以直接拿掉這段
        jQuery(function($) {
            $.datepicker.setDefaults({
                closeText: "關閉",
                prevText: "&#x3C;上月",
                nextText: "下月&#x3E;",
                currentText: "今天",
                monthNames: [ "一月","二月","三月","四月","五月","六月",
                "七月","八月","九月","十月","十一月","十二月" ],
                monthNamesShort: [ "一月","二月","三月","四月","五月","六月",
                "七月","八月","九月","十月","十一月","十二月" ],
                dayNames: [ "星期日","星期一","星期二","星期三","星期四","星期五","星期六" ],
                dayNamesShort: [ "周日","周一","周二","周三","周四","周五","周六" ],
                dayNamesMin: [ "日","一","二","三","四","五","六" ],
                weekHeader: "周",
                dateFormat: "yy-mm-dd",
                firstDay: 1,
                isRTL: false,
                showMonthAfterYear: true,
                yearSuffix: "年"
              });

            $("#datepicker").datepicker();

            $('#monthly').datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'yy-mm',
                onClose: function(dateText, inst) {
                    $(this).datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, 1));
                }
            });
        });
    </script>

</body>

</html>